<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>ぺちぱな。Q 〜たまには決められた通りに繰り返すのもいい〜</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <style>
            body {
                padding-top: 50px;
                padding-bottom: 20px;
            }
        </style>

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="js/vendor/prettify/prettify.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/jquery-1.10.1.min.js"></script>
        <script src="js/main.js"></script>
        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/jquery.easing.1.3.js"></script>
        <script src="js/vendor/prettify/prettify.js"></script>
    </head>

    <body onload="prettyPrint();">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-3 sidebar">
                    <ul class="nav nav-sidebar">
                        <li>
                            <a href="javascript:smoothScroll('1_0');" style="color : black;">
                                1. はじめに
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('1_1');">
                                配布資料の確認
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('1_2');">
                                コンピュータゲームの歴史
                            </a>
                        </li>


                        <li>
                            <a href="javascript:smoothScroll('1_3');">
                                enchant.js&nbsp;とは
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('1_4');">
                                サンプルを動かしてみよう
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('2_0');" style="color : black;">
                                2. enchant.jsを使ったゲームの仕組み
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('2_1');">
                                ゲームプログラムはパラパラ漫画のように
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('2_2');">
                                enchant.jsのセットアップ
                            </a>
                        </li>


                        <li>
                            <a href="javascript:smoothScroll('2_3');">
                                前準備はクラスの定義から
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('2_4');">
                                メインループの基本処理
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('3_0');" style="color : black;">
                                3. クマを動かせるようにしてみよう
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('3_1');">
                                スプライトを描画する
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('3_2');">
                                キー入力を受け取る&nbsp;〜もしなになにだったら〜
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('3_3');">
                                クマを動かせるようにしてみよう:実践編
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('4_0');" style="color : black;">
                                4. 障害物を設置して、衝突判定をつけてみよう
                            </a>
                        </li>

                        <li>
                            <a href="javascript:smoothScroll('5_0');" style="color : black;">
                                5. ゲームとしての体裁を整えよう
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="col-sm-9 col-sm-offset-3" style="position:absolute;top:0px;">
                    <div class="page-header">
                        <h1>ぺちぱな。Q <small>〜たまには決められた通りに繰り返すのもいい〜</small></h1>
                    </div>

                    <div class="section_block">
                        <div class="page-header">
                            <h2 id="1_0">1. はじめに</h2>
                        </div>

                        <!-- exam_content -->
                        <div class="exam_content">
                            <a href="javascript:smoothScroll('my_top');">
                                ↑トップへ戻る
                            </a>

                            <!-- 序文 -->
                            <div class="exam_description">
                                <p>
                                    おはようございます！<b>「ぺちぱな。Q 〜たまには決められた通りに繰り返すのもいい〜」</b>へようこそ！<br />
                                    今回のハンズオンはenchant.jsと言うJavaScriptライブラリを使って<b>「ゲームがどのような仕組みで動いているのか」</b>をテーマに行います！<br />
                                    用意はよろしいですか？それでは、張り切ってまいりましょう！どうぞ！
                                </p>
                            </div>

                            <!-- 配布資料の確認 -->
                            <div class="exam_inline">
                                <h3 id="1_1">配布資料の確認</h3>

                                <div class="exam_description">
                                    <p>
                                        まず、はじめに本日のハンズオンの配布資料を確認します。<br />
                                        とは言っても、全部を説明するわけではなくて主要となるファイルにフォーカスをあてて紹介したいと思います！
                                    </p>
                                </div>

                                <ul>
                                    <li>
                                        <dl>
                                            <dt>index.html</dt>
                                            <dd style="margin-top : 5px;">
                                                <p>
                                                    みなさまが、今開いているガイドブックです。<br />ここのファイルに手を加えていくことは今回はありません〜。
                                                </p>
                                            </dd>
                                        </dl>
                                    </li>

                                    <li>
                                        <dl>
                                            <dt>cook/</dt>
                                            <dd style="margin-top : 5px;">
                                                <p>
                                                    本日のハンズオンでみなさまに編集していただくファイルや<br />サンプルのプログラムがまとめてこのフォルダに入っています。
                                                </p>
                                            </dd>
                                        </dl>
                                    </li>

                                    <li>
                                        <dl>
                                            <dt>cook/chapter2/<br />cook/chapter3</dt>
                                            <dd style="margin-top : 5px;">
                                                <p>
                                                    本日のハンズオンでは章構成のようになっております。<br />chapter2ではツイートを。chapter3ではリプライを取り上げます。<br />各章で利用するプログラムはこの中に全て格納されています！
                                                </p>
                                            </dd>
                                        </dl>
                                    </li>
                                </ul>
                            </div>

                            <!-- コンピュータゲームの歴史 -->
                            <div class="exam_inline">
                                <h3 id="1_2">コンピュータゲームの歴史</h3>
                                <div class="well exam_margin">
                                    <h5>1840年代</h5>
                                    <i>
                                        イギリスの数学者チャールズ・バベッジは、機械にゲームを行わせることに興味を持ち、解析エンジン（コンピュータ）を考えた。ただし、チェスの場合は組合せが膨大になることから成功しなかった。
                                    </i>

                                    <h5>1983年</h5>
                                    <i>
                                        7月15日 - 任天堂「ファミリーコンピュータ」（ファミコン）
                                    </i>

                                    <h5>1994年</h5>
                                    <i>
                                        11月22日 - セガ「セガサターン」。同時発売としてビクターVサターン・日立Hiサターンがある。
                                    </i>

                                    <div class="quote">
                                        Wikipedia - <a href="http://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%82%B2%E3%83%BC%E3%83%A0%E3%81%AE%E6%AD%B4%E5%8F%B2" target="_blank">コンピュータゲームの歴史</a> より
                                    </div>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        コンピュータゲームの歴史を紐解いてみると、はじまりはなんと1840年頃からとなっており、今日までで170年ほどの歴史があります。<br />
                                        僕の家にはじめてやってきたゲーム機はファミコンでした。はじまりから何年も先の話です。スーパーマリオブラザーズばっかり遊んでいました。<br /><br />
                                        それが、時が経ってセガサターンやプレイステーションが登場し、2Dのものから奥行きのある3Dのゲームが家庭用ゲーム機にも登場してきて、グラフィック・演出も格段にパワーアップしました。<b>「実写のようだな」「とんでもない事が起きてしまった」</b>と当時思ったりしたものでした。<br /><br />
                                        そんな事がゲーム機の世代が変わる度に起こるとは予想も出来ず、大人になった今でも次世代機が発表される度に・新しいゲームが発表される度にわくわくするとは思ってもいませんでした。<br /><br />

                                        今回の「ぺちぱな。」ではそんなゲームがいったいぜんたいどのような仕組みで動いてるのか？をテーマに行います！<br />
                                        ゲーム開発向けフレームワークでもあります<b>enchant.js</b>を使って、グラフィックの描画・動き・衝突判定を持ったゲームを作りながら、ゲームの仕組みを知っていけたらと思います。
                                    </p>
                                </div>
                            </div>

                            <!-- enchant.js&nbsp;とは -->
                            <div class="exam_inline">
                                <h3 id="1_3">enchant.js&nbsp;とは</h3>

                                <div class="exam_description">
                                    <p>
                                        enchant.jsは<b>株式会社ユビキタスエンターテインメント</b>が開発したゲーム開発向けのHTML5/JavaScriptベースのフレームワークです。
                                    </p>
                                    <img src="./img/enchantjs.png" class="img-thumbnail img-responsive" alt="enchant.js">
                                </div>

                                <div class="well">
                                    <ul>
                                        <li>
                                            <i>
                                                ゲームやアプリを開発できる HTML5 + JavaScript フレームワークです。
                                            </i>
                                        </li>

                                        <li>
                                            <i>
                                                2011年に公開され、すでに 1,000 本以上のゲーム/アプリが公開されています。
                                            </i>
                                        </li>

                                        <li>
                                            <i>
                                                オープンソース (MITライセンス) で、無料で利用できます。
                                            </i>
                                        </li>

                                        <li>
                                            <i>
                                                ドキュメント・書籍・チュートリアルサイトが充実しています。
                                            </i>
                                        </li>

                                        <li>
                                            <i>
                                                たくさんのプラグインで機能を拡張できます。
                                            </i>
                                        </li>

                                        <li>
                                            <i>
                                                UEI/ARC を中心としたメンバによって開発・メンテナンスされています。
                                            </i>
                                        </li>

                                        <li>
                                            <i>
                                                プログラミング教育のためにも利用されています。
                                            </i>
                                        </li>
                                    </ul>
                                    <div class="quote">
                                        enchant.js - A simple JavaScript framework for creating games and apps.  - <a href="http://enchantjs.com/ja/" target="_blank">enchant.js is...</a> より
                                    </div>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        enchant.jsでは「物体の描画」「キー入力」「衝突判定」と言ったゲーム開発に必要な機能が扱いやすい形で提供されています。<br />
                                        今回は基本機能の部分でenchant.jsに乗っかりつつ、ゲームがどのように作られているのか見ていきたいと思います。<br /><br />

                                        なお、enchant.jsで作られたゲームは、投稿型ゲームサイト<a href="http://9leap.net" target="_blank">9leap</a>に投稿し、公開する事が出来ます。<br />
                                        教育用途でも使われている事から開発にも幾分取っ掛かりやすく(少ないコード量で、大きな動きがつけれたり)<br />
                                        作ったものを公開し・遊んでもらえる環境まで整っているためプログラミングの入門としても適したコンテンツとなっています:-)
                                    </p>
                                </div>
                            </div>

                            <!-- サンプルを動かしてみる -->
                            <div class="exam_inline">
                                <h3 id="1_4">サンプルを動かしてみよう</h3>
                                <div class="exam_description">
                                    <p>
                                        enchant.jsを使ってどんなゲームを作る事が出来るのか、一例としてサンプルのゲームを動かしてみます！<br />
                                        サンプルのゲームは以下のリンクからアクセスする事が出来ます。少しだけ遊んでみましょう！<br /><br />

                                        &gt;&gt; <a href="../Sample/shooting/index.html" target="_blank">shooting</a>
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        画面上でマウスを操作すると、ゲームが開始します。<br />
                                        マウスの動きにあわせて上下に移動しながら、向かってくる敵を倒していくシンプルなシューティングゲームになっています。<br />
                                        他にも様々なジャンルのサンプルが用意されており、enchant.jsではゲームを作るための機能が一通り揃ったフレームワークとなっています。<br /><br />
                                        他にもどんなゲームがあるか気になる方は、<a href="http://9leap.net" target="_blank">9leap</a>にユーザーが開発したゲームが数多く投稿されています。<br />
                                        興味のある方はこちらも合わせてご覧ください :-)
                                    </p>
                                </div>
                            </div>

                        </div>
                        <!-- exam_content -->
                    </div>

                    <div class="section_block">
                        <div class="page-header">
                            <h2 id="2_0">2. enchant.jsを使ったゲームの仕組み</h2>
                        </div>

                        <!-- exam_content -->
                        <div class="exam_content">
                            <a href="javascript:smoothScroll('my_top');">
                                ↑トップへ戻る
                            </a>

                            <div class="exam_description">
                                <p>
                                    ここでは、実際にキャラクターを操作するプログラムを書いて、ゲームがどのようにして動いているのかを見ていきたいと思います。
                                </p>
                            </div>

                            <!-- ゲームプログラムはパラパラ漫画のように -->
                            <div class="exam_inline">
                                <h3 id="2_1">ゲームプログラムはパラパラ漫画のように</h3>

                                <div class="exam_description">
                                    <p>
                                        ゲームプログラムの仕組みをざっくりと別の何かに例えると、<b>ページがどこまでも続くパラパラ漫画</b>に例えることが出来ます。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        <div class="align_center">
                                            <img src="./img/palapala.jpg" class="img-thumbnail img-responsive" alt="enchant.js">
                                            <h5>Wikipedia - パラパラ漫画より</h5>
                                        </div>
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        ゲームのプログラムはパラパラ漫画のように絶えず画面が更新される仕組みとなっており、この中で事前に組み込んだプログラムが決められた通りに動いていきます。このような仕組みの事をプログラム的に<b>メインループ</b>と呼んでいます。<br />
                                        メインループ上にユーザーのキー操作・時間の経過などを定義する事によって、ページがめくられる度に画面の情報が更新されていくイメージになります。そうとは言っても、これだけではピンと来ないところもあるかもしれません。<br />
                                        そこで、実際にキャラクターを操作するプログラムを作りながら、より詳しく紹介したいと思います。
                                    </p>
                                </div>
                            </div>

                            <!-- enchant.jsのセットアップ -->
                            <div class="exam_inline">
                                <h3 id="2_2">enchant.jsのセットアップ</h3>

                                <div class="exam_description">
                                    <p>
                                        enchant.jsを使ったゲーム開発をはじめるにあたってenchant.jsのセットアップを行います。<br />
                                        本項では既に用意されたものを使って、セットアップにあたってどういった記述が必要なのか要点をかいつまんで紹介します。<br /><br />

                                        みなさまに編集していただくソースファイルは、下記ディレクトリに保管されています。<br />
                                        これらをもとに簡単な紹介を行いますので、こちらのプログラムをお好みのテキストエディタで開いてからご確認ください。
                                    </p>
                                </div>

                                <ul>
                                    <li>
                                        <dl>
                                            <dt><a href="../src/edit/index.html" target="_blank">~/src/edit/index.html</a></dt>
                                            <dd style="margin-top : 5px;">
                                                <p>
                                                    開発したゲームが実行されるページのファイルとなります。<br />
                                                    こちらはテキストエディタと合わせてブラウザでもファイル名のリンクから確認してみましょう！
                                                </p>
                                            </dd>
                                        </dl>
                                    </li>

                                    <li>
                                        <dl>
                                            <dt>~/src/edit/main.js/</dt>
                                            <dd style="margin-top : 5px;">
                                                <p>
                                                    ゲームの実行にあたって、必要な処理はこちらに書いていきます。<br />
                                                    今回のハンズオンでも実際に編集するファイルはこちらのみとなっております。
                                                </p>
                                            </dd>
                                        </dl>
                                    </li>
                                </ul>

                                <div class="exam_description">
                                    <p>
                                        みなさま、お好みのテキストエディタでソースファイルを開いていただけたでしょうか？<br />
                                        ~/src/edit/index.htmlのプログラムをブラウザ上で確認すると、以下のような画面が表示されます。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        <div class="align_center">
                                            <img src="./img/2-1.png" class="img-thumbnail img-responsive" alt="enchant.js">
                                            <h5>So Spacy!(とても、宇宙的...)</h5>
                                        </div>
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        宇宙空間を背景に野生のくまが駆け抜けると言うなかなかに<b>スペイシー</b>な画面が表示されるかと思います、いかがでしょうか。<br />
                                        今回のハンズオンではこちらのプログラムを拡張していきながら、ゲームがどのようにして動いているのか紹介します。<br />
                                        まずはじめにenchant.jsで作ったゲームを動かすにあたって、どのような準備が必要なのかを紹介します。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <h4>../src/edit/index.html</h4>
                                    <pre class="prettyprint lang-html linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta http-equiv="x-ua-compatible" content="IE=Edge"&gt;
    &lt;meta name="viewport" content="width=device-width, user-scalable=no"&gt;
    &lt;meta name="apple-mobile-web-app-capable" content="yes"&gt;
    &lt;script type="text/javascript" src="./libs/enchant.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="main.js"&gt;&lt;/script&gt;
    &lt;style type="text/css"&gt;
        body {
            margin: 0;
            padding: 0;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        enchant.jsではページを表示するindex.htmlに対して、処理を書く事は基本的にありません。<br />
                                        ソースコード上の8行目と9行目で呼び出されている外部JavaScriptファイルの呼び出しが肝の部分になっています。<br /><br />
                                        こちらでenchant.jsの機能を呼び出す為の準備を行っていて、処理自体はmain.jsに書いていく事になります。<br />
                                        main.jsで書かれた処理をもとにして、ページ上でゲームが実行される仕組みとなります。<br /><br />
                                    </p>
                                </div>


                                <div class="exam_description">
                                    <h4>~/src/edit/main.js</h4>
                                    <pre class="prettyprint lang-js linenums">
enchant();  // enchant.jsの利用宣言　必ず最初に宣言する

window.onload = function(){
    var game_score    = 0;
    var window_width  = 320;    // ゲーム領域の幅
    var window_height = 568;    // ゲーム領域の高さ

    // CoreObjectの定義
    var core = new Core(window_width,window_height);
    core.fps = 30.0;
    core.preload('./libs/images/chara1.png', 
                 './libs/images/background.png',
                 './libs/images/pipe.png',
                 './libs/images/status_banner.png');

    core.onload = function(){
        // クマ (プレイヤーの定義)
        var bear   = new Sprite(32,32);                         // 画像描画開始の宣言
        bear.image = core.assets['./libs/images/chara1.png'];   // 描画する画像を指定する
        bear.x     = (window_width/2)-(32/2);                   // 画像の描画位置の指定(x軸)
        bear.y     = (window_height/2)-(32/2);                  // 画像の描画位置の指定(軸)

        /* 
            背景のスクロール処理(非表示にしています...)
        */

        // 定義した画像を、事前に描画する
        core.rootScene.addChild(bear);

        // メインループ
        core.on('enterframe', function(){
            // この中に処理を書いていきます
        });
    }

    core.start();
};

...</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        おっとっと、いきなりのプログラムになんだか目眩が・・・。enchant.jsはコードの頭で<b>enchant();</b>を呼び出す事ではじめて使えるようになります。ちょっと面食らう部分もあるかもしれませんが、今回の進行上で重要な部分だけをピックアップしてここでは紹介したいと思います。
                                    </p>
                                </div>
                            </div>

                            <!-- 前準備はクラスの定義から -->
                            <div class="exam_inline">
                                <h3 id="2_3">前準備はクラスの定義から</h3>
                                <div class="exam_description">
                                    <h4>~/src/edit/main.js</h4>
                                    <pre class="prettyprint lang-js linenums">
enchant();  // enchant.jsの利用宣言　必ず最初に宣言する

window.onload = function(){
    var game_score    = 0;
    var window_width  = 320;    // ゲーム領域の幅
    var window_height = 568;    // ゲーム領域の高さ

    // CoreObjectの定義
    var core = new Core(window_width,window_height);
    core.fps = 30.0;
    core.preload('./libs/images/chara1.png', 
                 './libs/images/background.png',
                 './libs/images/pipe.png',
                 './libs/images/status_banner.png');

... 途中省略 ...
</pre>
                                </div>


                                <div class="exam_description">
                                    <p>
                                        JavaScriptでは<b>window.onload = function(){}</b>の<b>{}</b>で囲われた領域のプログラムが画面読み込み時に実行されます。<br />
                                        ここでは<b>9行目</b>でenchant.jsが提供している、Coreクラスのインスタンスを生成しています。<br /><br />
                                        引数に幅と高さをそれぞれセットする事でウィンドウ領域のサイズを決める事が出来ます。<b>window_width</b>と<b>window_height</b>の数値に合わせてサイズが変化するようになっているので、良かったら話を聞きながらでも弄ったりしてみてください:-)<br /><br />
                                        クラスとは用途を絞った機能群を包括した器のようなもので、Coreクラスにはゲームの進行全般を管理する為の機能がまとめられています。<br />
                                        クラスというのがいったいなんなのかピンと来ない人は<b>親子丼</b>をイメージしてみましょう。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        <div class="align_center">
                                            <img src="./img/oyako.jpg" class="img-thumbnail img-responsive" alt="美味しそう">
                                        </div>
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        親子丼を親子丼たらしめるには、まっさらな器だけでは難しいものがあります。<br />
                                        親子丼たらしめるべく器に<b>ご飯</b>をよそい<b>だしの効いた半熟のとき卵</b>・<b>鶏肉</b>・<b>三つ葉</b>を乗せなければなりません。<br />
                                        クラスもまっさらなままでは、そのクラスが何を為しているのかがわかりません。<br /><br />
                                        そのためCoreクラスでは<b>ゲームの進行を管理する</b>事をテーマにして、進行管理に必要な機能・細かい設定項目を取りまとめています。<br />
                                        開発者は提供されているクラスをインスタンス化する事によって、手っ取り早くそれらの機能を利用する事が出来るようになります。<br /><br />
                                        今回のぺちぱな。ではCoreクラス以外にもいくつかのクラスが登場します。<br />
                                        クラスごとにどういった用途があって、どのようにして使われるのかはその都度合わせて紹介したいと思います。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <h4>~/src/edit/main.js</h4>
                                    <pre class="prettyprint lang-js linenums:9">
var core = new Core(window_width,window_height);
core.fps = 30.0;
core.preload('./libs/images/chara1.png', 
             './libs/images/background.png',
             './libs/images/pipe.png',
             './libs/images/status_banner.png');

... 途中省略 ...
</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        Coreクラスのインスタンスを生成したら、さらに設定を行っていきます。ソースコードの10行目では<b>FPS</b>の設定を行っています。<br />
                                        FPSは一秒あたりに処理される映像数を表しています。core.fpsには<b>30.0</b>を代入しているので、この例では一秒あたりに30回分のループが行われる事を意味しています。<br /><br />
                                        パラパラ漫画に例えると、一秒間に30ページずつめくれていくイメージで考えていただけると大丈夫です:-)<br /><br />
                                        11行目では<b>preload</b>と言う命令を呼び出して、事前に読み込む画像をセットしています。今回は事前に利用する画像を全てセットしているので、ここに対して手を加えていく事はありません。もし、ご自身で画像を追加したいと思った時にはこちらも忘れずに追加するようにしておきましょう:-)
                                    </p>
                                </div>
                            </div>
                            <!-- exam_inline -->

                            <!-- メインループの基本処理 -->
                            <div class="exam_inline">
                                <h3 id="2_4">メインループの基本処理</h3>
                                <div class="exam_description">
                                    <h4>~/src/edit/main.js</h4>
                                    <pre class="prettyprint lang-js linenums:14">
... 途中省略 ...

core.onload = function(){
    // クマ (プレイヤーの定義)
    var bear   = new Sprite(32,32);                         // 画像描画開始の宣言
    bear.image = core.assets['./libs/images/chara1.png'];   // 描画する画像を指定する
    bear.x     = (window_width/2)-(32/2);                   // 画像の描画位置の指定(x軸)
    bear.y     = (window_height/2)-(32/2);                  // 画像の描画位置の指定(軸)

    /* 
        背景のスクロール処理(非表示にしています...)
    */

    // 定義した画像を、事前に描画する
    core.rootScene.addChild(bear);

    // メインループ
    core.on('enterframe', function(){
        // この中に処理を書いていきます
    });
}

core.start();

... 途中省略 ...
</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        ソースコードの<b>16行目</b>から無名関数内にゲーム中の処理を定義しています。この辺りからの内容がメイン部分の処理になってきます。<br />
                                        定義した無名関数を<b>core.onload</b>に代入する事で代入された関数の処理に沿ってゲームが動きます。<br /><br />

                                        <b>31行目</b>からはメインループの定義を書いています。また、メインループより前にはゲーム上で利用される画像の描画を行っています。<br />
                                        波括弧の範囲内に書いたプログラムは、ページを読み込んだ後もくり返しくり返し実行されます。この中でユーザーのキー入力などはを受け取りながら、事前に定義した決められた処理を決められた通りにくり返して行くわけです:-)<br /><br />

                                        とは言っても、ここまでの内容だけではいまいちピンと来ない部分もあるかもしれません。<br />
                                        そこで、次の項目では画像の描画についても取り上げつつ、実際にクマを操作するプログラムを作ってより詳しく内容を見ていきます。
                                    </p>
                                </div>
                            </div>
                            <!-- exam_inline -->
                        </div>
                        <!-- exam_content -->
                    </div>


                    <div class="section_block">
                        <div class="page-header">
                            <h2 id="3_0">3. クマを表示して動かせるようにしてみよう</h2>
                        </div>

                        <!-- exam_content -->
                        <div class="exam_content">
                            <a href="javascript:smoothScroll('my_top');">
                                ↑トップへ戻る
                            </a>

                            <div class="exam_description">
                                <p>
                                    2章ではenchant.jsのセットアップを皮切りに、大枠の動きと仕組みについて紹介を行いました。<br />
                                    3章では、2章でちょっと出てきた<b>メインループ</b>がどういうものなのかをプログラムを書きながら紹介したいと思います。<br />
                                    実際にキー入力操作を受け取るプログラムを書いて、クマを動かせるようにしてみましょう:-)
                                </p>
                            </div>

                            <!-- クマの画像を描画する -->
                            <div class="exam_inline">
                                <h3 id="3_1">スプライトを描画する</h3>

                                <div class="exam_description">
                                    <p>
                                        画像を描画するには、<b>Sprite</b/>クラスを用いて行います。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <h4>~/Chapter/Chapter3/edits/main.js</h4>
                                    <pre class="prettyprint lang-js linenums:10">
... 途中省略 ...

core.onload = function(){
    // クマ (プレイヤーの定義)
    var size   = 32;
    var bear   = new Sprite(size,size);
    bear.image = core.assets['./libs/images/chara1.png'];   // 描画する画像を指定する
    bear.x     = (window_width/2)-(size/2);                 // 画像の描画位置の指定(x軸)
    bear.y     = (window_height/2)-(size/2);                // 画像の描画位置の指定(軸)
    bear.frame = 0;                                         // 描画領域の範囲を指定する
    core.rootScene.addChild(bear);                          // クマを画面上に描画する
}

</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        Spriteクラスをインスタンス化する時に、引数に描画する画像の幅と高さをそれぞれセットする事ができます。<br />
                                        こうする事で<b>スプライト</b>を生成する事が出来ます。<b>スプライト</b>はイメージ的には額のようなもので、実際の画像から描画領域を決定してはめこまれた物が画面上に表示されるようになっています。<br />ここでは描画を行う前に画像の指定と、それをどこに描画するのかx軸とy軸それぞれに指定しています。<br />
                                        実際に<b>16行目</b>で指定している画像chara1.pngは以下のような画像になっています。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        <div class="align_center">
                                            <img src="./img/3-1.png" class="img-thumbnail img-responsive" alt="3-1.png">
                                            <h5>いろいろなクマが...</h5>
                                        </div>

                                        <div class="align_center">
                                            <img src="./img/3-1_mark.png" class="img-thumbnail img-responsive" alt="3-1_mark.png">
                                            <h5>bear.frameの値に合わせて変わるんです。</h5>
                                        </div>
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        このように複数の画像を1つの画像にタイル状に取りまとめたものを<b>スプライトシート</b>と言います。
                                        個別に画像を準備する場合と比べた場合、役割に合わせて画像をまとめる事で管理が行いやすく、画像の容量を抑える事が出来るメリットがあります。<br /><br />
                                        enchant.jsではこのようなスプライトシートを手軽に使う為の機能が提供されています。<b>19行目</b>の<b>bear.frame</b>がそうです。<br /><br />
                                        明示的に指定していない場合、ないしは0を代入している場合はスプライトシートの左上を基準にインスタンス化した際に引数で渡した画像の幅と高さをもとにしてスプライトを生成します。試しにサンプルのプログラムで<b>bare.frame</b>に代入する値を0から1へとじゅんぐり上げていくと赤枠の描画領域から、右に1つずつずれて表示されます。もし良かったら聞きながらでも構いませんので、いろいろと数値をいじってどうなるか試してみてください:-)
                                    </p>
                                </div>
                            </div>

                            <!-- キー入力を受け取る&nbsp;〜もしなになにだったら〜 -->
                            <div class="exam_inline">
                                <h3 id="3_2">キー入力を受け取る&nbsp;〜もしなになにだったら〜</h3>

                                <div class="exam_description">
                                    <p>
                                        スプライト描画についての仕組みがわかったところで、いよいよ描画されたクマをユーザーの操作で動かせるようにしていきます。<br />
                                        実際に、キー入力によってクマが上下左右に入力されたキーに合わせて動くようにします。<br /><br />
                                        キー入力を受け取って画面に結果を反映させる為には<b>「もし上方向にキーが押されていたら」</b><b>「もし下方向にキーが押されていたら」</b>のように<b>「もしなになにだったら」</b>と言う処理を追加してあげなければなりません。JavaScriptでは<b>if文</b>を使うことによって実現する事が出来ます。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <h4>JavaScriptでもしもなになにだったら〜</h4>
                                    <pre class="prettyprint lang-js linenums">
// 単体
if (/* 条件式 */) {
    // 条件式に一致した時に実行される処理
}

// 複数分岐
if (/* 条件1 */) {
    // 条件1に一致した時に実行される処理
}else if (/* 条件2 */){
    // 条件2に一致した時に実行される処理
}else{
    // 条件1にも条件2にも一致しない場合実行される処理
}

// 例 ログには「正」の字が出力される
var value = 1;
if(value==1){
    console.log('正');
}else{
    console.log('不正');
}
</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        JavaScriptにおけるif文の書き方は上記のような形になっています。条件式をもとにして正しい内容であれば、括弧の中へと処理が進んでいくようになります。また、<b>else if</b>を使うことによって、複数の条件を候補としたより柔軟な処理が行えるようになります。<br /><br />
                                        この内容をもとにして、キー入力を受け取れるようにしたサンプルが下記になります。
                                    </p>
                                </div>

                                <div class="exam_description">
                                    <h4>~/Chapter/Chapter3/inputs/main.js</h4>
                                    <pre class="prettyprint lang-js linenums">
enchant();  // enchant.jsの利用宣言　必ず最初に宣言する

window.onload = function(){
    var window_width  = 320;    // ゲーム領域の幅
    var window_height = 568;    // ゲーム領域の高さ

    // CoreObjectの定義
    var core = new Core(window_width,window_height);
    core.fps = 30.0;

    core.onload = function(){
        // メインループ（この中に処理を書いていきます)
        core.on('enterframe', function(){
            if(core.input.up){
                console.log('方向キーの上キーが押されました');
            }else if (core.input.down){
                console.log('方向キーの下キーが押されました');
            }else if (core.input.left){
                console.log('方向キーの左キーが押されました');
            }else if (core.input.right){
                console.log('方向キーの右キーが押されました');
            }
        });
    }

    core.start();
};
</pre>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        <a href="../Chapter/Chapter3/inputs/index.html" target="_blank">ブラウザから確認すると</a>、画面上ではこれと言って何も表示されていませんが、上下左右の方向キーのいずれかを入力すると、対応する形が出力される事を確認する事ができます。<br />
                                        <b>enchant.js</b>はCoreクラスの<b>input</b>がゲームに対する入力操作を管理しており、<b>if文</b>を使ってこのような形で条件式としてメインループ内で定義することによってユーザーのキー入力に対する処理を実装する事が出来ます。
                                    </p>
                                </div>
                            </div>


                            <!-- クマを動かせるようにしてみよう:実践編 -->
                            <div class="exam_inline">
                                <h3 id="3_3">クマを動かせるようにしてみよう:実践編</h3>

                                <div class="exam_description">
                                    <p>
                                        それではここまでの内容を踏まえて、クマを操作して動かす為のプログラムを書いてみましょう。<br />
                                        なお、はじめに処理の流れを確認したいと思います。おおまかな処理の流れは以下の通りです。
                                    </p>
                                </div>

                                <div class="well">
                                    <h5>おだいもく</h5>
                                    <ul class="procedure">
                                        <li>処理自体はメインループの中に定義していく</li>
                                        <li>現在中央に表示されている、クマをキー入力に合わせて動かせるようにする</li>
                                        <li>if文を使って「もし上方向に押されていたら」と言う形で、上下左右の方向キーに対する処理を追加する</li>
                                        <li>3番で定義したif文にそれぞれクマの移動処理を実装します</li>
                                    </ul>
                                </div>

                                <div class="exam_description">
                                    <p>
                                        なお、描画されたクマのスプライトの座標は<b>bear.x, bear.y</b>のように定義したスプライトの<b>x, y</b>それぞれに数値を代入する事で表示される座標を更新する事が出来るようになっています。<br />
                                        この点に対してあらかじめ確認した上で、クマを自由に動けるようにプログラムを拡張してみましょう:-)
                                    </p>
                                </div>
                            </div>
                        </div>
                        <!-- exam_content -->
                    </div>

                    <div class="section_block">
                        <div class="page-header">
                            <h2 id="4_0">4. 障害物を設置して、衝突判定をつけてみよう</h2>
                        </div>

                        <!-- exam_content -->
                        <div class="exam_content">
                            <a href="javascript:smoothScroll('my_top');">
                                ↑トップへ戻る
                            </a>

                            <div class="exam_description">
                                <p>
                                    ここでは、実際にキャラクターを操作するプログラムを書いて、ゲームがどのようにして動いているのかを見ていきたいと思います。
                                </p>
                            </div>
                        </div>
                        <!-- exam_content -->
                    </div>
                    <!-- section -->

                    <div class="section_block">
                        <div class="page-header">
                            <h2 id="5_0">5. ゲームとしての体裁を整えよう</h2>
                        </div>

                        <!-- exam_content -->
                        <div class="exam_content">
                            <a href="javascript:smoothScroll('my_top');">
                                ↑トップへ戻る
                            </a>

                            <div class="exam_description">
                                <p>
                                    2章ではenchant.jsのセットアップを皮切りに、大枠の動きと仕組みの紹介を行いました。<br />
                                    3
                                </p>
                            </div>
                        </div>
                        <!-- exam_content -->
                    </div>
                    <!-- section -->
                </div>
            </div>
        </div>

        <script>
            function smoothScroll(node){
                var pos = $( "#"+node).position();
                $('html,body').animate({ scrollTop: pos.top-60}, 1000, 'easeOutQuad');
            }
        </script>
    </body>
</html>